(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2035:function(e,t,s){Promise.resolve().then(s.bind(s,6789))},6789:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var i,n,h=s(7437),r=s(2265);function o(e){let[t,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{window.addEventListener("click",()=>s(e.character.isMenuOpened))},[]),(0,h.jsxs)("div",{className:"menu",style:{display:t?"flex":"none"},children:[(0,h.jsxs)("label",{className:"menu-item",children:["Character color:",(0,h.jsx)("input",{type:"color",defaultValue:e.character.color,onChange:function(t){e.character.color=t.target.value}})]}),(0,h.jsxs)("label",{className:"menu-item",children:["Shot color:",(0,h.jsx)("input",{type:"color",defaultValue:e.character.shotColor,onChange:function(t){e.character.shotColor=t.target.value}})]}),(0,h.jsxs)("label",{className:"menu-item",children:["Character speed:",(0,h.jsx)("input",{type:"range",defaultValue:e.character.speed,min:1,max:50,step:1,onChange:function(t){e.character.speed=parseInt(t.target.value)}})]}),(0,h.jsxs)("label",{className:"menu-item",children:["Fire rate:",(0,h.jsx)("input",{type:"range",defaultValue:1/e.character.fireRate,min:.02,max:1,step:.02,onChange:function(t){e.character.fireRate=Math.round(1/parseFloat(t.target.value))}})]}),(0,h.jsxs)("label",{className:"menu-item",children:["Shot speed:",(0,h.jsx)("input",{type:"range",defaultValue:e.character.shotSpeed,min:1,max:100,step:1,onChange:function(t){e.character.shotSpeed=parseInt(t.target.value)}})]}),(0,h.jsx)("button",{type:"button",className:"btn-menu-close",onClick:function(){e.character.closeMenu(),s(e.character.isMenuOpened)},children:"\xd7"})]})}class a{move(){switch(this._direction){case a.Direction.Up:this.posY-=this.speed;return;case a.Direction.Down:this.posY+=this.speed;return;case a.Direction.Left:this.posX-=this.speed;return;case a.Direction.Right:this.posX+=this.speed;return;default:throw Error("No such Direction!")}}constructor(e,t,s,i,n,h,r){this._scene=e,this.posX=t,this.posY=s,this.speed=n,this.color=h,this.radius=r,this._direction=i,e.registerRenderedObject(this)}}(n=(i=a||(a={})).Direction||(i.Direction={}))[n.Up=0]="Up",n[n.Down=1]="Down",n[n.Left=2]="Left",n[n.Right=3]="Right";var c=a;class l extends c{update(){this.move(),this.checkBorderCollision()}render(e){e.beginPath(),e.arc(this.posX,this.posY,this.radius,0,2*Math.PI),e.fillStyle=this.color,e.fill()}hitCharacter(){this.destroy()}checkBorderCollision(){let e=this.radius,t=this.posX+e<0,s=this.posX-e>this._scene.width;(t||s)&&this.destroy()}destroy(){this._scene.forgetRenderedObject(this)}constructor(e,t,s,i,n,h,r,o){super(t,s,i,r,h,n,o),this.owner=e}}let d="#0099FF";class u extends c{update(){this.move(),this.checkBorderCollision(),this.checkMouseCollision(),this.shoot()}render(e){e.beginPath(),e.arc(this.posX,this.posY,this.radius,0,2*Math.PI),e.fillStyle=this.color,e.fill(),e.fillStyle=d,e.textAlign="center",e.textBaseline="middle",e.font=this.radius/2+"px serif",e.fillText(this._score.toString(),this.posX,this.posY,2*this.radius)}openMenu(){this.isMenuOpened=!0,this._scene.pause()}closeMenu(){this.isMenuOpened=!1,this._scene.start()}shoot(){if(this._shotReadiness<this.fireRate)this._shotReadiness++;else{this._shotReadiness=0;let[e,t]=this.getBulletSpawnPoint();new l(this,this._scene,e,t,this.shotColor,this.shotSpeed,this._shotDirection,this.radius/5)}}countHit(){this._score++}destroy(){this._scene.forgetRenderedObject(this)}checkBorderCollision(){let e=this.radius,t=this.posY-e<0,s=this.posY+e>this._scene.height;if(t){this._direction=u.Direction.Down;let t=this.posY-e;this.posY=0-t+e}if(s){this._direction=u.Direction.Up;let t=this.posY+e-this._scene.height;this.posY=this._scene.height-t-e}}checkMouseCollision(){let e=Math.sqrt(Math.pow(this.posX-this._scene.mouseX,2)+Math.pow(this.posY-this._scene.mouseY,2));.5*this.radius<e&&e<1.1*this.radius&&(this._scene.mouseY<this.posY&&(this._direction=u.Direction.Down),this._scene.mouseY>this.posY&&(this._direction=u.Direction.Up))}getBulletSpawnPoint(){let e,t;switch(this._shotDirection){case c.Direction.Up:e=this.posX,t=this.posY-this.radius;break;case c.Direction.Down:e=this.posX,t=this.posY+this.radius;break;case c.Direction.Left:e=this.posX-this.radius,t=this.posY;break;case c.Direction.Right:e=this.posX+this.radius,t=this.posY;break;default:throw Error("No such Direction!")}return[e,t]}handleClick(){Math.sqrt(Math.pow(this.posX-this._scene.mouseX,2)+Math.pow(this.posY-this._scene.mouseY,2))<2*this.radius&&this.openMenu()}constructor(e,t,s,i,n,h,r,o,a,c,l){super(e,t,s,i,n,h,l),this.isMenuOpened=!1,this._shotReadiness=0,this._score=0,this._shotDirection=r,this.fireRate=o,this.shotSpeed=a,this.shotColor=c,window.addEventListener("click",()=>this.handleClick())}}class p{registerRenderedObject(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];this._renderedObjects.push(...t)}forgetRenderedObject(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];for(let e of t){let t=this._renderedObjects.findIndex(t=>t===e);this._renderedObjects.splice(t,1)}}pause(){this.isPaused||(this.isPaused=!0,cancelAnimationFrame(this._animationFrameId))}start(){return!this.isPaused||this.player.isMenuOpened||this.enemy.isMenuOpened?0:(this.isPaused=!1,this._animationFrameId=requestAnimationFrame(e=>this.tickFrame(e,0)))}initPlayers(){let e=this.height/15,t=this.height/2,s=new u(this,2*e,t,u.Direction.Up,5,"#FFFFFF",u.Direction.Right,10,20,"#00FFFF",e),i=new u(this,this.width-2*e,t,u.Direction.Down,5,"#000000",u.Direction.Left,10,20,"#FF0000",e);return this.registerRenderedObject(s,i),[s,i]}handleResizeAndOnload(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height}tickFrame(e,t){let s;let i=e-t;i>=this._fpsInterval&&(s=e-i%this._fpsInterval,this.calculateBulletCollision(),this.renderFrame()),this._animationFrameId=requestAnimationFrame(e=>this.tickFrame(e,null!=s?s:t))}renderFrame(){if(this._context.clearRect(0,0,this.width,this.height),this._context&&(this._context.fillStyle=d,this._context.fillRect(0,0,this.width,this.height),this._renderedObjects.length>0))for(let e of this._renderedObjects)e.update(),e.render(this._context)}calculateBulletCollision(){for(let e of this._renderedObjects)if(e instanceof l){if(e.owner!==this.player&&this.calculateCollision(this.player.radius,this.player.posX,this.player.posY,e.radius,e.posX,e.posY)){this.enemy.countHit(),e.hitCharacter();return}if(e.owner!==this.enemy&&this.calculateCollision(this.enemy.radius,this.enemy.posX,this.enemy.posY,e.radius,e.posX,e.posY)){this.player.countHit(),e.hitCharacter();return}}}calculateCollision(e,t,s,i,n,h){return Math.sqrt(Math.pow(t-n,2)+Math.pow(s-h,2))<e+i}handleMouseMove(e){this.mouseX=e.pageX,this.mouseY=e.pageY}constructor(){this.mouseX=0,this.mouseY=0,this.isPaused=!0,this._fpsInterval=1e3/30,this.canvas=document.createElement("canvas"),this._context=this.canvas.getContext("2d"),this._renderedObjects=[],this.width=window.innerWidth,this.height=window.innerHeight,[this.player,this.enemy]=this.initPlayers(),this.handleResizeAndOnload(),window.addEventListener("resize",()=>this.handleResizeAndOnload()),window.addEventListener("onload",()=>this.handleResizeAndOnload()),window.addEventListener("mousemove",e=>this.handleMouseMove(e)),this._animationFrameId=this.start()}}function m(){let e=(0,r.useRef)(null),[t,s]=(0,r.useState)((0,h.jsx)(h.Fragment,{}));return(0,r.useEffect)(()=>{var t;let i=new p;i.canvas.className="scene-canvas",null==e||null===(t=e.current)||void 0===t||t.appendChild(i.canvas),s((0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(o,{character:i.player}),(0,h.jsx)(o,{character:i.enemy})]}))},[]),(0,h.jsx)("div",{className:"canvas-container",ref:e,children:t})}function f(){return(0,h.jsx)("main",{children:(0,h.jsx)(m,{})})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=2035)}),_N_E=e.O()}]);